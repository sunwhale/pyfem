# -*- coding: utf-8 -*-
"""

"""
from numpy import array

from pyfem.fem.constants import DTYPE
from pyfem.quadrature.BaseQuadrature import BaseQuadrature
from pyfem.utils.colors import error_style


class TetrahedronQuadrature(BaseQuadrature):
    """
    计算笛卡尔坐标系下标准四面体的积分点坐标和权重::

       (0,0,1)
        3
        * **
        *   * *
        *     *  *
        *       *   2 (0,1,0)
        *        **  *
        ζ     *     * *
        |  η          **
        0---ξ * * * * * 1
       (0,0,0)         (1,0,0)

    """

    __slots__ = BaseQuadrature.__slots__ + []

    def __init__(self, order: int, dimension: int) -> None:
        dimension = 3
        super().__init__(order, dimension)
        if order == 1:  # order 1, qp_number 1
            qp_coords_and_weights = array([
                [0.2500000000000000, 0.2500000000000000, 0.2500000000000000, 0.1666666666666667]], dtype=DTYPE)
        elif order == 2:  # order 2, qp_number 4
            qp_coords_and_weights = array([
                [0.1381966011250110, 0.1381966011250110, 0.1381966011250110, 0.0416666666666667],
                [0.5854101966249680, 0.1381966011250110, 0.1381966011250110, 0.0416666666666667],
                [0.1381966011250110, 0.5854101966249680, 0.1381966011250110, 0.0416666666666667],
                [0.1381966011250110, 0.1381966011250110, 0.5854101966249680, 0.0416666666666667]], dtype=DTYPE)
        elif order == 3:  # order 3, qp_number 10
            qp_coords_and_weights = array([
                [0.0738349017262234, 0.0738349017262234, 0.0738349017262234, 0.0079388558072015],
                [0.7784952948213300, 0.0738349017262234, 0.0738349017262234, 0.0079388558072015],
                [0.0738349017262234, 0.7784952948213300, 0.0738349017262234, 0.0079388558072015],
                [0.0738349017262234, 0.0738349017262234, 0.7784952948213300, 0.0079388558072015],
                [0.4062443438840510, 0.0937556561159491, 0.0937556561159491, 0.0224852072396435],
                [0.0937556561159491, 0.4062443438840510, 0.0937556561159491, 0.0224852072396435],
                [0.0937556561159491, 0.0937556561159491, 0.4062443438840510, 0.0224852072396435],
                [0.4062443438840510, 0.4062443438840510, 0.0937556561159491, 0.0224852072396435],
                [0.4062443438840510, 0.0937556561159491, 0.4062443438840510, 0.0224852072396435],
                [0.0937556561159491, 0.4062443438840510, 0.4062443438840510, 0.0224852072396435]], dtype=DTYPE)
        elif order == 5:  # order 5, qp_number 20
            qp_coords_and_weights = array([
                [0.0323525947272439, 0.0323525947272439, 0.0323525947272439, 0.0011778457990783],
                [0.9029422158182680, 0.0323525947272439, 0.0323525947272439, 0.0011778457990783],
                [0.0323525947272439, 0.9029422158182680, 0.0323525947272439, 0.0011778457990783],
                [0.0323525947272439, 0.0323525947272439, 0.9029422158182680, 0.0011778457990783],
                [0.6165965330619370, 0.0603604415251421, 0.0603604415251421, 0.0078331114953146],
                [0.2626825838877790, 0.0603604415251421, 0.0603604415251421, 0.0078331114953146],
                [0.0603604415251421, 0.6165965330619370, 0.0603604415251421, 0.0078331114953146],
                [0.0603604415251421, 0.2626825838877790, 0.0603604415251421, 0.0078331114953146],
                [0.0603604415251421, 0.0603604415251421, 0.6165965330619370, 0.0078331114953146],
                [0.0603604415251421, 0.0603604415251421, 0.2626825838877790, 0.0078331114953146],
                [0.2626825838877790, 0.6165965330619370, 0.0603604415251421, 0.0078331114953146],
                [0.6165965330619370, 0.2626825838877790, 0.0603604415251421, 0.0078331114953146],
                [0.2626825838877790, 0.0603604415251421, 0.6165965330619370, 0.0078331114953146],
                [0.6165965330619370, 0.0603604415251421, 0.2626825838877790, 0.0078331114953146],
                [0.0603604415251421, 0.2626825838877790, 0.6165965330619370, 0.0078331114953146],
                [0.0603604415251421, 0.6165965330619370, 0.2626825838877790, 0.0078331114953146],
                [0.3097693042728620, 0.3097693042728620, 0.0706920871814129, 0.0169894863816447],
                [0.3097693042728620, 0.0706920871814129, 0.3097693042728620, 0.0169894863816447],
                [0.0706920871814129, 0.3097693042728620, 0.3097693042728620, 0.0169894863816447],
                [0.3097693042728620, 0.3097693042728620, 0.3097693042728620, 0.0169894863816447]], dtype=DTYPE)
        elif order == 6:  # order 6, qp_number 35
            qp_coords_and_weights = array([
                [0.0267367755543735, 0.0267367755543735, 0.0267367755543735, 0.0003650077327565],
                [0.9197896733368800, 0.0267367755543735, 0.0267367755543735, 0.0003650077327565],
                [0.0267367755543735, 0.9197896733368800, 0.0267367755543735, 0.0003650077327565],
                [0.0267367755543735, 0.0267367755543735, 0.9197896733368800, 0.0003650077327565],
                [0.7477598884818090, 0.0391022406356488, 0.0391022406356488, 0.0023899278362944],
                [0.1740356302468940, 0.0391022406356488, 0.0391022406356488, 0.0023899278362944],
                [0.0391022406356488, 0.7477598884818090, 0.0391022406356488, 0.0023899278362944],
                [0.0391022406356488, 0.1740356302468940, 0.0391022406356488, 0.0023899278362944],
                [0.0391022406356488, 0.0391022406356488, 0.7477598884818090, 0.0023899278362944],
                [0.0391022406356488, 0.0391022406356488, 0.1740356302468940, 0.0023899278362944],
                [0.1740356302468940, 0.7477598884818090, 0.0391022406356488, 0.0023899278362944],
                [0.7477598884818090, 0.1740356302468940, 0.0391022406356488, 0.0023899278362944],
                [0.1740356302468940, 0.0391022406356488, 0.7477598884818090, 0.0023899278362944],
                [0.7477598884818090, 0.0391022406356488, 0.1740356302468940, 0.0023899278362944],
                [0.0391022406356488, 0.1740356302468940, 0.7477598884818090, 0.0023899278362944],
                [0.0391022406356488, 0.7477598884818090, 0.1740356302468940, 0.0023899278362944],
                [0.4547545999844830, 0.0452454000155172, 0.0452454000155172, 0.0041717565947791],
                [0.0452454000155172, 0.4547545999844830, 0.0452454000155172, 0.0041717565947791],
                [0.0452454000155172, 0.0452454000155172, 0.4547545999844830, 0.0041717565947791],
                [0.4547545999844830, 0.4547545999844830, 0.0452454000155172, 0.0041717565947791],
                [0.4547545999844830, 0.0452454000155172, 0.4547545999844830, 0.0041717565947791],
                [0.0452454000155172, 0.4547545999844830, 0.4547545999844830, 0.0041717565947791],
                [0.2232010379623150, 0.2232010379623150, 0.0504792790607720, 0.0079973222176259],
                [0.5031186450145980, 0.2232010379623150, 0.0504792790607720, 0.0079973222176259],
                [0.2232010379623150, 0.5031186450145980, 0.0504792790607720, 0.0079973222176259],
                [0.2232010379623150, 0.0504792790607720, 0.2232010379623150, 0.0079973222176259],
                [0.5031186450145980, 0.0504792790607720, 0.2232010379623150, 0.0079973222176259],
                [0.2232010379623150, 0.0504792790607720, 0.5031186450145980, 0.0079973222176259],
                [0.0504792790607720, 0.2232010379623150, 0.2232010379623150, 0.0079973222176259],
                [0.0504792790607720, 0.5031186450145980, 0.2232010379623150, 0.0079973222176259],
                [0.0504792790607720, 0.2232010379623150, 0.5031186450145980, 0.0079973222176259],
                [0.5031186450145980, 0.2232010379623150, 0.2232010379623150, 0.0079973222176259],
                [0.2232010379623150, 0.5031186450145980, 0.2232010379623150, 0.0079973222176259],
                [0.2232010379623150, 0.2232010379623150, 0.5031186450145980, 0.0079973222176259],
                [0.2500000000000000, 0.2500000000000000, 0.2500000000000000, 0.0155290955199223]], dtype=DTYPE)
        elif order == 8:  # order 8, qp_number 56
            qp_coords_and_weights = array([
                [0.0149520651530592, 0.0149520651530592, 0.0149520651530592, 0.0001728852056023],
                [0.9551438045408220, 0.0149520651530592, 0.0149520651530592, 0.0001728852056023],
                [0.0149520651530592, 0.9551438045408220, 0.0149520651530592, 0.0001728852056023],
                [0.0149520651530592, 0.0149520651530592, 0.9551438045408220, 0.0001728852056023],
                [0.1518319491659370, 0.0340960211962615, 0.0340960211962615, 0.0016002774233247],
                [0.7799760084415400, 0.0340960211962615, 0.0340960211962615, 0.0016002774233247],
                [0.0340960211962615, 0.1518319491659370, 0.0340960211962615, 0.0016002774233247],
                [0.0340960211962615, 0.7799760084415400, 0.0340960211962615, 0.0016002774233247],
                [0.0340960211962615, 0.0340960211962615, 0.1518319491659370, 0.0016002774233247],
                [0.0340960211962615, 0.0340960211962615, 0.7799760084415400, 0.0016002774233247],
                [0.7799760084415400, 0.1518319491659370, 0.0340960211962615, 0.0016002774233247],
                [0.1518319491659370, 0.7799760084415400, 0.0340960211962615, 0.0016002774233247],
                [0.7799760084415400, 0.0340960211962615, 0.1518319491659370, 0.0016002774233247],
                [0.1518319491659370, 0.0340960211962615, 0.7799760084415400, 0.0016002774233247],
                [0.0340960211962615, 0.7799760084415400, 0.1518319491659370, 0.0016002774233247],
                [0.0340960211962615, 0.1518319491659370, 0.7799760084415400, 0.0016002774233247],
                [0.5526556431060170, 0.0462051504150017, 0.0462051504150017, 0.0027415662799705],
                [0.3549340560639790, 0.0462051504150017, 0.0462051504150017, 0.0027415662799705],
                [0.0462051504150017, 0.5526556431060170, 0.0462051504150017, 0.0027415662799705],
                [0.0462051504150017, 0.3549340560639790, 0.0462051504150017, 0.0027415662799705],
                [0.0462051504150017, 0.0462051504150017, 0.5526556431060170, 0.0027415662799705],
                [0.0462051504150017, 0.0462051504150017, 0.3549340560639790, 0.0027415662799705],
                [0.3549340560639790, 0.5526556431060170, 0.0462051504150017, 0.0027415662799705],
                [0.5526556431060170, 0.3549340560639790, 0.0462051504150017, 0.0027415662799705],
                [0.3549340560639790, 0.0462051504150017, 0.5526556431060170, 0.0027415662799705],
                [0.5526556431060170, 0.0462051504150017, 0.3549340560639790, 0.0027415662799705],
                [0.0462051504150017, 0.3549340560639790, 0.5526556431060170, 0.0027415662799705],
                [0.0462051504150017, 0.5526556431060170, 0.3549340560639790, 0.0027415662799705],
                [0.2281904610687610, 0.2281904610687610, 0.0055147549744775, 0.0025624627752218],
                [0.5381043228880020, 0.2281904610687610, 0.0055147549744775, 0.0025624627752218],
                [0.2281904610687610, 0.5381043228880020, 0.0055147549744775, 0.0025624627752218],
                [0.2281904610687610, 0.0055147549744775, 0.2281904610687610, 0.0025624627752218],
                [0.5381043228880020, 0.0055147549744775, 0.2281904610687610, 0.0025624627752218],
                [0.2281904610687610, 0.0055147549744775, 0.5381043228880020, 0.0025624627752218],
                [0.0055147549744775, 0.2281904610687610, 0.2281904610687610, 0.0025624627752218],
                [0.0055147549744775, 0.5381043228880020, 0.2281904610687610, 0.0025624627752218],
                [0.0055147549744775, 0.2281904610687610, 0.5381043228880020, 0.0025624627752218],
                [0.5381043228880020, 0.2281904610687610, 0.2281904610687610, 0.0025624627752218],
                [0.2281904610687610, 0.5381043228880020, 0.2281904610687610, 0.0025624627752218],
                [0.2281904610687610, 0.2281904610687610, 0.5381043228880020, 0.0025624627752218],
                [0.3523052600879940, 0.3523052600879940, 0.0992057202494530, 0.0048920019729205],
                [0.1961837595745600, 0.3523052600879940, 0.0992057202494530, 0.0048920019729205],
                [0.3523052600879940, 0.1961837595745600, 0.0992057202494530, 0.0048920019729205],
                [0.3523052600879940, 0.0992057202494530, 0.3523052600879940, 0.0048920019729205],
                [0.1961837595745600, 0.0992057202494530, 0.3523052600879940, 0.0048920019729205],
                [0.3523052600879940, 0.0992057202494530, 0.1961837595745600, 0.0048920019729205],
                [0.0992057202494530, 0.3523052600879940, 0.3523052600879940, 0.0048920019729205],
                [0.0992057202494530, 0.1961837595745600, 0.3523052600879940, 0.0048920019729205],
                [0.0992057202494530, 0.3523052600879940, 0.1961837595745600, 0.0048920019729205],
                [0.1961837595745600, 0.3523052600879940, 0.3523052600879940, 0.0048920019729205],
                [0.3523052600879940, 0.1961837595745600, 0.3523052600879940, 0.0048920019729205],
                [0.3523052600879940, 0.3523052600879940, 0.1961837595745600, 0.0048920019729205],
                [0.1344783347929940, 0.1344783347929940, 0.1344783347929940, 0.0061048561067518],
                [0.5965649956210170, 0.1344783347929940, 0.1344783347929940, 0.0061048561067518],
                [0.1344783347929940, 0.5965649956210170, 0.1344783347929940, 0.0061048561067518],
                [0.1344783347929940, 0.1344783347929940, 0.5965649956210170, 0.0061048561067518]], dtype=DTYPE)
        elif order == 9:  # order 9, qp_number 84
            qp_coords_and_weights = array([
                [0.0268784744148170, 0.0268784744148170, 0.0268784744148170, 0.0003574891907193],
                [0.9193645767555490, 0.0268784744148170, 0.0268784744148170, 0.0003574891907193],
                [0.0268784744148170, 0.9193645767555490, 0.0268784744148170, 0.0003574891907193],
                [0.0268784744148170, 0.0268784744148170, 0.9193645767555490, 0.0003574891907193],
                [0.1871406758034700, 0.1871406758034700, 0.1871406758034700, 0.0034711069484615],
                [0.4385779725895910, 0.1871406758034700, 0.1871406758034700, 0.0034711069484615],
                [0.1871406758034700, 0.4385779725895910, 0.1871406758034700, 0.0034711069484615],
                [0.1871406758034700, 0.1871406758034700, 0.4385779725895910, 0.0034711069484615],
                [0.4735758351279370, 0.0264241648720630, 0.0264241648720630, 0.0012016893440758],
                [0.0264241648720630, 0.4735758351279370, 0.0264241648720630, 0.0012016893440758],
                [0.0264241648720630, 0.0264241648720630, 0.4735758351279370, 0.0012016893440758],
                [0.4735758351279370, 0.4735758351279370, 0.0264241648720630, 0.0012016893440758],
                [0.4735758351279370, 0.0264241648720630, 0.4735758351279370, 0.0012016893440758],
                [0.0264241648720630, 0.4735758351279370, 0.4735758351279370, 0.0012016893440758],
                [0.3520452620273560, 0.1479547379726440, 0.1479547379726440, 0.0051331531932853],
                [0.1479547379726440, 0.3520452620273560, 0.1479547379726440, 0.0051331531932853],
                [0.1479547379726440, 0.1479547379726440, 0.3520452620273560, 0.0051331531932853],
                [0.3520452620273560, 0.3520452620273560, 0.1479547379726440, 0.0051331531932853],
                [0.3520452620273560, 0.1479547379726440, 0.3520452620273560, 0.0051331531932853],
                [0.1479547379726440, 0.3520452620273560, 0.3520452620273560, 0.0051331531932853],
                [0.7323099096929470, 0.0209534422200560, 0.0209534422200560, 0.0007263074689773],
                [0.0209534422200560, 0.7323099096929470, 0.0209534422200560, 0.0007263074689773],
                [0.0209534422200560, 0.0209534422200560, 0.7323099096929470, 0.0007263074689773],
                [0.2257832058669400, 0.7323099096929470, 0.0209534422200560, 0.0007263074689773],
                [0.2257832058669400, 0.0209534422200560, 0.7323099096929470, 0.0007263074689773],
                [0.0209534422200560, 0.2257832058669400, 0.7323099096929470, 0.0007263074689773],
                [0.2257832058669400, 0.0209534422200560, 0.0209534422200560, 0.0007263074689773],
                [0.0209534422200560, 0.2257832058669400, 0.0209534422200560, 0.0007263074689773],
                [0.0209534422200560, 0.0209534422200560, 0.2257832058669400, 0.0007263074689773],
                [0.7323099096929470, 0.2257832058669400, 0.0209534422200560, 0.0007263074689773],
                [0.7323099096929470, 0.0209534422200560, 0.2257832058669400, 0.0007263074689773],
                [0.0209534422200560, 0.7323099096929470, 0.2257832058669400, 0.0007263074689773],
                [0.6475575940869750, 0.0969897331234660, 0.0969897331234660, 0.0014322551129722],
                [0.0969897331234660, 0.6475575940869750, 0.0969897331234660, 0.0014322551129722],
                [0.0969897331234660, 0.0969897331234660, 0.6475575940869750, 0.0014322551129722],
                [0.1584629396660920, 0.6475575940869750, 0.0969897331234660, 0.0014322551129722],
                [0.1584629396660920, 0.0969897331234660, 0.6475575940869750, 0.0014322551129722],
                [0.0969897331234660, 0.1584629396660920, 0.6475575940869750, 0.0014322551129722],
                [0.1584629396660920, 0.0969897331234660, 0.0969897331234660, 0.0014322551129722],
                [0.0969897331234660, 0.1584629396660920, 0.0969897331234660, 0.0014322551129722],
                [0.0969897331234660, 0.0969897331234660, 0.1584629396660920, 0.0014322551129722],
                [0.6475575940869750, 0.1584629396660920, 0.0969897331234660, 0.0014322551129722],
                [0.6475575940869750, 0.0969897331234660, 0.1584629396660920, 0.0014322551129722],
                [0.0969897331234660, 0.6475575940869750, 0.1584629396660920, 0.0014322551129722],
                [0.3221114318308570, 0.3221114318308570, 0.0336657045074290, 0.0038334469448810],
                [0.3221114318308570, 0.0336657045074290, 0.3221114318308570, 0.0038334469448810],
                [0.0336657045074290, 0.3221114318308570, 0.3221114318308570, 0.0038334469448810],
                [0.3221114318308570, 0.3221114318308570, 0.3221114318308570, 0.0038334469448810],
                [0.0976081628904420, 0.0976081628904420, 0.0118444177494980, 0.0008105106508187],
                [0.7929392564696180, 0.0976081628904420, 0.0118444177494980, 0.0008105106508187],
                [0.0976081628904420, 0.7929392564696180, 0.0118444177494980, 0.0008105106508187],
                [0.0976081628904420, 0.0118444177494980, 0.0976081628904420, 0.0008105106508187],
                [0.7929392564696180, 0.0118444177494980, 0.0976081628904420, 0.0008105106508187],
                [0.0976081628904420, 0.0118444177494980, 0.7929392564696180, 0.0008105106508187],
                [0.0118444177494980, 0.0976081628904420, 0.0976081628904420, 0.0008105106508187],
                [0.0118444177494980, 0.7929392564696180, 0.0976081628904420, 0.0008105106508187],
                [0.0118444177494980, 0.0976081628904420, 0.7929392564696180, 0.0008105106508187],
                [0.7929392564696180, 0.0976081628904420, 0.0976081628904420, 0.0008105106508187],
                [0.0976081628904420, 0.7929392564696180, 0.0976081628904420, 0.0008105106508187],
                [0.0976081628904420, 0.0976081628904420, 0.7929392564696180, 0.0008105106508187],
                [0.1335581607035680, 0.2965010205431240, 0.0287564059530710, 0.0025991900130432],
                [0.5411844128002370, 0.1335581607035680, 0.0287564059530710, 0.0025991900130432],
                [0.2965010205431240, 0.5411844128002370, 0.0287564059530710, 0.0025991900130432],
                [0.2965010205431240, 0.1335581607035680, 0.0287564059530710, 0.0025991900130432],
                [0.5411844128002370, 0.2965010205431240, 0.0287564059530710, 0.0025991900130432],
                [0.1335581607035680, 0.5411844128002370, 0.0287564059530710, 0.0025991900130432],
                [0.1335581607035680, 0.0287564059530710, 0.2965010205431240, 0.0025991900130432],
                [0.5411844128002370, 0.0287564059530710, 0.1335581607035680, 0.0025991900130432],
                [0.2965010205431240, 0.0287564059530710, 0.5411844128002370, 0.0025991900130432],
                [0.2965010205431240, 0.0287564059530710, 0.1335581607035680, 0.0025991900130432],
                [0.5411844128002370, 0.0287564059530710, 0.2965010205431240, 0.0025991900130432],
                [0.1335581607035680, 0.0287564059530710, 0.5411844128002370, 0.0025991900130432],
                [0.0287564059530710, 0.1335581607035680, 0.2965010205431240, 0.0025991900130432],
                [0.0287564059530710, 0.5411844128002370, 0.1335581607035680, 0.0025991900130432],
                [0.0287564059530710, 0.2965010205431240, 0.5411844128002370, 0.0025991900130432],
                [0.0287564059530710, 0.2965010205431240, 0.1335581607035680, 0.0025991900130432],
                [0.0287564059530710, 0.5411844128002370, 0.2965010205431240, 0.0025991900130432],
                [0.0287564059530710, 0.1335581607035680, 0.5411844128002370, 0.0025991900130432],
                [0.5411844128002370, 0.1335581607035680, 0.2965010205431240, 0.0025991900130432],
                [0.2965010205431240, 0.5411844128002370, 0.1335581607035680, 0.0025991900130432],
                [0.1335581607035680, 0.2965010205431240, 0.5411844128002370, 0.0025991900130432],
                [0.5411844128002370, 0.2965010205431240, 0.1335581607035680, 0.0025991900130432],
                [0.1335581607035680, 0.5411844128002370, 0.2965010205431240, 0.0025991900130432],
                [0.2965010205431240, 0.1335581607035680, 0.5411844128002370, 0.0025991900130432]], dtype=DTYPE)
        else:
            raise NotImplementedError(error_style('order must be 1, 2, 3, 5, 6, 8 or 9'))

        self.qp_coords = qp_coords_and_weights[:, 0:3]
        self.qp_weights = qp_coords_and_weights[:, 3:4].reshape(-1)
        self.qp_number = len(self.qp_weights)


if __name__ == "__main__":
    from pyfem.utils.visualization import print_slots_dict

    print_slots_dict(TetrahedronQuadrature.__slots_dict__)

    quadrature = TetrahedronQuadrature(3, 3)
    quadrature.show()
